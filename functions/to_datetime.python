{"version":"NotebookV1","origId":2674386794047489,"name":"to_datetime","language":"python","commands":[{"version":"CommandV1","origId":2674386794047490,"guid":"cebc2a66-84c8-40a0-a9ce-2ff059b38b55","subtype":"command","commandType":"auto","position":1.0,"command":"from pyspark.sql import SparkSession, Row\nfrom pyspark.sql.types import *\nfrom pyspark.sql.functions import col\n\nfrom datetime import datetime, timedelta\nfrom email.utils import parsedate_tz\nfrom dateutil.parser import parse\n\ndef to_datetime(datestring):\n    time_tuple = parsedate_tz(datestring.strip())\n    dt = datetime(*time_tuple[:6])\n    return dt - timedelta(seconds=time_tuple[-1])\n  \nspark.udf.register(\"to_datetime\", to_datetime, DateType())","commandVersion":5,"state":"finished","results":{"type":"listResults","data":[{"type":"ansi","data":"Out[2]: <function __main__.to_datetime(datestring)>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1661118906041,"submitTime":1661118906030,"finishTime":1661118906176,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"Tratamento de datas","showCommandTitle":true,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["ansi",51]],"subcommandOptions":null,"nuid":"8b36b924-397b-497c-9314-ea3f6b002971"},{"version":"CommandV1","origId":2674386794047491,"guid":"836519bd-b811-452f-9b3d-cf8a446574bd","subtype":"command","commandType":"auto","position":2.0,"command":"","commandVersion":0,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"nuid":"f555427f-9c14-416c-bd46-fd8b20b7401c"}],"dashboards":[],"guid":"38ec0e8c-be2c-40dd-b503-3b2f96efcec6","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{"pythonIndentUnit":2}}